const mongoose = require('mongoose');

// Conectar ao MongoDB
mongoose.connect('mongodb+srv://anacarolinasevero:anacarolinasevero@cluster0.mongodb.net/espaco-guapa?retryWrites=true&w=majority', {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

// Lista de nomes fornecida pelo usu√°rio (primeiros ~100)
const nomesFornecidos = [
  'Adelaide Nascimento',
  'Adele Motta',
  'Adriana Conti',
  'Adriana Cristina Ferrari Capodifoglio',
  'Adriana da Silva',
  'Adriana de Godoy Santos',
  'Adriana Eloisa Cancian Pinto',
  'Adriana Fu',
  'Adriana Helena Barbosa',
  'ADRIANA HELENA MARTINI DE MORAES',
  'Adriana Montan',
  'Adriana Moraes Massoli',
  'Adriana Regina Strabelli',
  'ADRIANE CRISPIM MESQUITA TAVANIELLI',
  'Adriele de Jesus Merces Pereira',
  'Agneyde Passos',
  'Alan Souza',
  'Alana Bagatini',
  'Alana de Brito',
  'Alana Moscardi',
  'Alessandra Almeida',
  'Alessandra Aparecida Bueno',
  'Alessandra Barros',
  'Alessandra Braz',
  'Alessandra Burin',
  'Alessandra Caravante de Oliveira',
  'Alessandra Dimitriou',
  'Alessandra Porcena',
  'Alessandra Santos Rocha',
  'Alessandro Ara√∫jo dos Santos',
  'Alexia Ramos dos Santos',
  'Alice Aguilar Martins',
  'Alice Carrera',
  'Alice Consuli',
  'Alice Doroteia',
  'Alice Emanuelly Barro dos Santos',
  'Alice Fioramonte de Andrade',
  'Alice Pagani Rodrigues',
  'Alice Volpi Porto',
  'Al√≠cia Barros da cruz',
  'Alicia Cavalcante de mesquita',
  'Alicia Mesquita',
  'Aliete Araujo Andrade',
  'Aline Baldin',
  'Aline Carrera',
  'Aline Cavalcante da Silva',
  'Aline chaves Dell agnese',
  'Aline Curtinho',
  'Aline Delinardi Ruozo',
  'Aline Fernanda de Carvalho',
  'ALINE FONTES RODRIGUES RUIS',
  'Aline Marchiori Cordeiro',
  'Aline Molina Gomes Amorim',
  'Aline Monzani',
  'Aline Nascimento',
  'Aline Rodrigues',
  'Aline Rom√£o da Silva',
  'Aline Ruozo',
  'Aline Sales Mouro',
  'Aline Santoro de Lima',
  'Aline Santos',
  'Aline Vila Manara',
  'Aline Zamboni',
  'Alissa Cardozo',
  'ALMO√áO',
  'Amabele Martins',
  'Amanda agbzubav',
  'Amanda Almeida Rodrigues',
  'Amanda Angelina Basaglia',
  'Amanda Ap. Antonio dos Santos',
  'Amanda Bueno',
  'Amanda Calili',
  'Amanda da Silva Pedroso Gomes',
  'Amanda Godoi',
  'Amanda Juliani Bispo',
  'Amanda Leveghim',
  'Amanda Ligero',
  'Amanda Martins',
  'Amanda Maziero',
  'Amanda Medeiros',
  'Amanda Morais',
  'Amanda morais silva',
  'Amanda Oliveira',
  'AMANDA PINARELLI',
  'Amanda Pinheiro',
  'Amanda Pinheiro',
  'Amanda Pinheiro (Leme)',
  'Amanda Piratelli',
  'Amanda Piratelli',
  'Amanda Roberta do Nascimento',
  'Amanda Rodrigues',
  'Amanda Rodriguez',
  'Amanda Santos',
  'Amanda Sbarai',
  'Amanda Serra',
  'Amanda Souto Maior',
  'Amanda Souza',
  'Amanda Turek',
  'Amanda Ulmann',
  'Amarilis',
  'Amarilis Ananda de Azevedo',
  'Ana',
  'Ana Alves',
  'Ana Andr√©a Corr√™a Pinheiro',
  'Ana Baldin',
  'Ana Barbara Omita Santos',
  'Ana Beatriz Campanholo',
  'Ana Beatriz Ligo',
  'Ana Beatriz Ligo',
  'Ana Behem',
  'Ana Belinato',
  'Ana Bueno',
  'Ana Carolina Barbante',
  'Ana Carolina Belinato de Oliveira',
  'Ana Carolina Capelini',
  'Ana Carolina de Marco',
  'Ana Carolina Gomes',
  'Ana Carolina Leite',
  'Ana Carolina Medeiros',
  'Ana carolina medeiros fonseca',
  'Ana Carolina Perin de Barros',
  'Ana Carolina Querino Lopes',
  'Ana Carolina Scherma Mudi',
  'Ana Carolina Severo',
  'Ana Carolina Silveira de Marco',
  'Ana Carolina Toledo',
  'Ana Clara Belinato',
  'Ana Clara Garcez',
  'Ana Clara Souza Cancian',
  'Ana Clara Troya Raineri Fiocco',
  'Ana Claudia',
  'Ana Claudia Bruno',
  'Ana Claudia Costa da Silva',
  'Ana Elisa Carrera',
  'Ana Elisa do Couto Carrera',
  'Ana Elisa Millan',
  'Ana Fl√°via Giassi',
  'Ana Fl√°via Tatis',
  'Ana Grynfogiel',
  'Ana Heizeinreider',
  'Ana Julia da Silva Braga',
  'Ana Julia Fiocco',
  'Ana J√∫lia Gaboardi',
  'Ana J√∫lia Miss√£o Ossuna',
  'Ana J√∫lia Neve dos Santos',
  'Ana Julia Rendeiro',
  'Ana Laura Carvalho de Oliveira',
  'Ana L√∫cia Lopes Marangoni',
  'Ana Lucia Penteado',
  'Ana L√∫cia Rezende',
  'Ana L√∫cia Schwenger Giratto',
  'Ana L√∫cia Silva Pereira',
  'Ana Lucia Stephani de Oliveira',
  'Ana Luisa Ata√≠de Moraes',
  'Ana Luiza',
  'Ana Luiza Arruda Ali',
  'Ana Luiza Colombo',
  'Ana Luiza de Camargo Doimo',
  'Ana Luiza Ferreira',
  'Ana Luiza Magalh√£es Cambuim',
  'Ana Maria Baldin Ruozo',
  'Ana Maria do Nascimento Moro',
  'Ana Medeiros',
  'Ana Moraes',
  'Ana Paula Batistela',
  'Ana Paula Bueno',
  'Ana Paula Ciccone',
  'Ana Paula da Silva',
  'Ana Paula de Souza Lodi',
  'Ana Paula Define',
  'Ana Paula Fernandes Joaquim',
  'Ana Paula Ferreira',
  'Ana Paula Miranda',
  'Ana Paula Ramos de Mattos',
  'Ana Paula Ribeiro',
  'Ana Paula Scatolini Batistela',
  'Ana Rinho',
  'Ana Rita Aguilar',
  'Ana Talita da Concei√ß√£o',
  'Ana Virg√≠nia Lot',
  'Ana Vit√≥ria Rezende',
  'Ana Vitoria Rezende Torres Teixeira',
  'Ana Vit√≥ria Soares Costa',
  'Ana Vit√≥ria Sousa Silva',
  'Anabrisa Tamaso Magalh√£es',
  'Ananda Bueno Soares',
  'Anaterra Dantas',
  'Andr√© Oshiro',
  'Andrea Carla Fiamini',
  'Andr√©a Correia',
  'Andr√©a Francisco Pereira',
  'Andr√©a Gomes Rodrigues Vale',
  'Andrea Santoro',
  'Andreia Bailos',
  'Andr√©ia Cruz',
  'Andr√©ia Martins',
  'Andr√©ia Nunes Souza Shima',
  'Andressa Aycha Rodrigues Carollo',
  'Andressa Fernandes',
  'Andressa Giseli Rosa',
  'Andressa Moraes Oliveira',
  'Andressa Parreira',
  'Andressa Paula Sampaio Rissatto',
  'Andressa Rosa',
  'Andressa Titoneli',
  'Andreya Maria de Souza Fonseca',
  'Andrezza Santos Lo√ßardo',
  '√Çngela Correa',
  '√Çngela Cristina Sbarai',
  '√Çngela Maria Camargo Castro de Almeida Queiroz',
  '√Çngela Rosolen',
  'Ang√©lica Bruzzone Marrero',
  'Angelica Soeiro',
  'Angelita Cancian',
  'Angelita dos Santos Furlan',
  'Aniele Malta',
  'Anieli Dias',
  'Anita Massucato',
  'Anna Beatriz Guerra',
  'Anna Clara Bovo Torquato',
  'Anna Clara Pires',
  'Anna Laura Santana dos Santos',
  'Anna Luiza Chimirri',
  'Anna Rebessi',
  'anne f√°tima theodoro',
  'Anne Rocha',
  'Annelise Colognesi Bratkowski',
  'Annie Helo√≠sa Camargo',
  'Anny Karolayne dos Santos Alves',
  'Antonia Charliane Gomes Pereira',
  'Ant√¥nia Rosineide',
  'Aparecida Marchetti Justino',
  'Aracheli',
  'Aracheli Peres Torres',
  'Aralys Gallo Ferreira da Silva',
  'Ariane Aparecida Gutzlaff da Silva',
  'Ariane borges meira',
  'Ariane de Cassia Lazari Dias',
  'Ariane Ferreira de Aguiar',
  'Ariane Meira',
  'Ariane Oliveira',
  'Arlete Bertoloti',
  'Arthur Carrera',
  'Arthur de Oliveira Torres',
  'Arthur Resende Chaves',
  'Atito',
  'Aurea magalhaes',
  'Aurestina Rodrigues',
  'Aurora',
  'Aurora Santana Costa',
  'Barbara Coelho de Souza',
  'Barbara Habermann Kelade',
  'B√°rbara Lopes',
  'Barbara Lopes dos Santos',
  'Barbara Miranda',
  'B√°rbara nascimento',
  'B√°rbara Oliveira de Carvalho',
  'Barbara privatti zani',
  'B√°rbara Rolim',
  'BARBARA TAISSA BARBIERO EMERENCIANO',
  'Beatriz Alexo',
  'Beatriz Aparecida Faustino',
  'Beatriz Baccarin',
  'Beatriz Batista Zachariotto',
  'Beatriz Campos Pereira Fraz√£o',
  'Beatriz caroline',
  'Beatriz Caroline de Souza',
  'Beatriz Cunha',
  'Beatriz da Silva Guidini Pistarini',
  'Beatriz Dorta Faldoni',
  'Beatriz Emanoela Beck Franchini',
  'Beatriz Franchini',
  'Beatriz Grossklauss',
  'Beatriz Kinock',
  'Beatriz Kinock',
  'Beatriz Martins',
  'Beatriz Mendes Ara√∫jo Carvalho',
  'Beatriz nascimento da Silva',
  'Beatriz Nunes',
  'Beatriz Rainho',
  'Beatriz Ribeiro Martoni',
  'Beatriz Rodrigues',
  'Beatriz Rodrigues',
  'Beatriz Rodrigues Rocha',
  'Beatriz Scherma Mudinuti',
  'Beco',
  'Bento Ferraz',
  'Beti Cresmasco',
  'Bia Alves',
  'Bia Alves',
  'Bianca Alves Almeida',
  'Bianca Cavalheiro',
  'Bianca Gon√ßalves',
  'Bianca Hildebrand',
  'Bianca Hildebrand e Silva',
  'Bianca Monteiro',
  'Bianca Priscila fontes de farias',
  'Bianca Priscila fontes dos Santos',
  'Bianca Rayssa Souza',
  'Bianca Rayssa Souza',
  'Bianca Rodrigues Gon√ßalves',
  'Bianca Tella',
  'Bianca Vit√≥ria da Silva Evangelista',
  'Bibiana Silveira',
  'Brenda',
  'Brenda Albuquerque Seneme',
  'Brenda Carolina Paganotti',
  'Brenda Gabriele Ara√∫jo Pedroso',
  'Brenda Longo',
  'Brenda Porfirio',
  'Brenda Porf√≠rio Da Silva',
  'Brenda Seneme',
  'Breno Comin',
  'Bru Carol soares',
  'BRU FORA',
  'Bruna Andriotti',
  'Bruna Ara√∫jo Santos',
  'Bruna Barro',
  'Bruna Bueno',
  'Bruna Canovas',
  'Bruna Canovas',
  'Bruna Daiana Martins Moreira',
  'Bruna Elisa Barboza de Souza',
  'Bruna Fantinato Van Leeuwen',
  'Bruna Felipe Fabiano',
  'Bruna Fernanda Alc√¢ntara da silva',
  'Bruna Germano da Silva',
  'Bruna Herget Bacher',
  'Bruna Lucheze',
  'Bruna Mariana Scavassa',
  'Bruna Marini',
  'Bruna Marucci Thomaz',
  'Bruna Moreira',
  'Bruna nicolau',
  'Bruna Nunes',
  'Bruna Prado',
  'Bruna Pultz',
  'Bruna Quirino Lopes',
  'Bruna Rafaela Bercke',
  'Bruna Ramos de Oliveira',
  'Bruna Rodrigues da Silva',
  'Bruna Rodrigues da Silva',
  'Bruna Rosalem',
  'Bruna Saraiva',
  'Bruna Silva',
  'Bruna Silva Melauro',
  'Bruna Soares',
  'Bruna Teresa Adami',
  'Bruna Timoteo',
  'Bruna Tognolli',
  'Bruna Yaskara',
  'Bruna Zambuzi',
  'Cacau',
  'Cain√£ de souza martins',
  'Caio Augusto L√©beis',
  'Caio Augusto L√©beis',
  'Camila Abreu',
  'Camila Albani',
  'Camila Arne',
  'Camila Audrey',
  'Camila Bertoloti Vieira das Neves',
  'Camila Bueno',
  'Camila Corr√™a',
  'Camila do Nascimento Nacarate',
  'Camila Fernanda Candido dos Santos',
  'Camila Ferreira Papin',
  'Camila Freire',
  'Camila Freire',
  'Camila Galiano',
  'Camila Guimaraes Martins Peres',
  'Camila Jos√©',
  'Camila Laet',
  'Camila Lopes',
  'Camila Mariel Juraski Machuca',
  'Camila Maruyama',
  'Camila Menegozzi',
  'Camila Nacarete',
  'Camila Neile Lopes',
  'Camila Ohoseki',
  'Camila Padilha Trindade',
  'Camila Padilha Trindade',
  'Camila Pedral',
  'Camila Peli√ßari',
  'Camila Rodrigues',
  'Camila Rodrigues Rocha Furlan',
  'Camila Rosa Oliveira',
  'Camila Santiago',
  'Camila Severo',
  'Camila Silva de Laet',
  'Camila Targino',
  'Camila Tissi',
  'Camila Torres Franco',
  'Camila Vieira de Moraes',
  'Camile Vit√≥ria Souza Martins Coelho',
  'Camilla Albani',
  'Camille Cunha Barbosa',
  'Camilly Lima',
  'Camilly Zanca',
  'Caren Vespa',
  'Carina Zaccariotto',
  'Carine Lima',
  'Carla (M√£e Aurora)',
  'Carla Bergamin Rosa',
  'Carla Fernanda Bardy',
  'Carla Lopes Rodriguez',
  'Carla Rosilene',
  'Carla Silva',
  'Carmen Robles',
  'Carmen Tetti',
  'Carol de Carli',
  'Carol Gierwatoviski',
  'Carol Laet',
  'Carol Maia',
  'Carol Pascuinelli',
  'Carol Pontes',
  'Carol Sarto',
  'Carol Vargas',
  'Carola Leite',
  'Carolina Bianchini',
  'Carolina Bonfanti Fiori',
  'Carolina Bueno',
  'Carolina Cavalheiro Padilha',
  'Carolina Domingos Peres Serrador',
  'Carolina Duarte',
  'Carolina Ferreira',
  'Carolina Ferreira',
  'Carolina Ishibashi',
  'Carolina Malta',
  'Carolina Mazzi',
  'Carolina Milanezi Manzini de Souza',
  'Carolina Motta',
  'Carolina Orpinelli',
  'Carolina Orpinelli',
  'Carolina Pereira Bersan',
  'Carolina Rocha Santos de Almeida',
  'Carolina Sato Pereira',
  'Carolina Zaccaro',
  'Caroline',
  'Caroline Batistela',
  'Caroline Brand√£o',
  'Caroline Costenaro',
  'Caroline Crespo',
  'Caroline Cristina da Silva',
  'Caroline de Oliveira dos Santos',
  'Caroline Doneg√° Cavallari',
  'Caroline Freire dos Santos',
  'Caroline Gisele Uscello',
  'Caroline Malvestiti',
  'Caroline Puya',
  'Caroline Querobim',
  'Caroline Sakamoto',
  'Caroline Vespa',
  'C√°ssia Boreli',
  'C√°ssia Gasperoni',
  'Cassia Guimar√£es',
  'Cassia Valentin do Nascimento',
  'Catarina da Mata',
  'Catharina Boldt'
];

async function compararNomes() {
  try {
    console.log('üîç Conectando ao banco de dados...');
    
    // Aguardar conex√£o
    await mongoose.connection.asPromise();
    console.log('‚úÖ Conectado ao MongoDB');
    
    // Buscar todos os clientes importados
    const db = mongoose.connection.db;
    const clientesCollection = db.collection('clients');
    
    console.log('üìä Buscando clientes no banco...');
    const clientesImportados = await clientesCollection.find({}).toArray();
    
    console.log(`üìà Total de clientes no banco: ${clientesImportados.length}`);
    
    // Extrair nomes dos clientes importados
    const nomesImportados = clientesImportados.map(cliente => cliente.name).filter(Boolean);
    
    console.log(`üìù Total de nomes v√°lidos no banco: ${nomesImportados.length}`);
    
    // Comparar nomes
    const nomesEncontrados = [];
    const nomesNaoEncontrados = [];
    
    for (const nome of nomesFornecidos) {
      // Normalizar nome para compara√ß√£o (remover acentos, mai√∫sculas, etc.)
      const nomeNormalizado = nome.toLowerCase()
        .normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '')
        .replace(/[^\w\s]/g, '')
        .trim();
      
      // Verificar se existe no banco
      const encontrado = nomesImportados.some(nomeBanco => {
        const nomeBancoNormalizado = nomeBanco.toLowerCase()
          .normalize('NFD')
          .replace(/[\u0300-\u036f]/g, '')
          .replace(/[^\w\s]/g, '')
          .trim();
        
        return nomeBancoNormalizado === nomeNormalizado;
      });
      
      if (encontrado) {
        nomesEncontrados.push(nome);
      } else {
        nomesNaoEncontrados.push(nome);
      }
    }
    
    // Exibir resultados
    console.log('\nüìä RESULTADO DA COMPARA√á√ÉO:');
    console.log('=====================================');
    console.log(`‚úÖ Nomes ENCONTRADOS no banco: ${nomesEncontrados.length}`);
    console.log(`‚ùå Nomes N√ÉO ENCONTRADOS no banco: ${nomesNaoEncontrados.length}`);
    console.log(`üìã Total de nomes verificados: ${nomesFornecidos.length}`);
    
    console.log('\n‚úÖ NOMES ENCONTRADOS:');
    nomesEncontrados.forEach((nome, index) => {
      console.log(`${index + 1}. ${nome}`);
    });
    
    console.log('\n‚ùå NOMES N√ÉO ENCONTRADOS:');
    nomesNaoEncontrados.forEach((nome, index) => {
      console.log(`${index + 1}. ${nome}`);
    });
    
    // Estat√≠sticas
    const percentualEncontrado = ((nomesEncontrados.length / nomesFornecidos.length) * 100).toFixed(1);
    console.log(`\nüìà PERCENTUAL: ${percentualEncontrado}% dos nomes foram encontrados no banco`);
    
    if (nomesNaoEncontrados.length > 0) {
      console.log('\n‚ö†Ô∏è  RECOMENDA√á√ïES:');
      console.log('- Verificar se os nomes n√£o encontrados foram importados com grafia diferente');
      console.log('- Verificar se houve problemas durante a importa√ß√£o');
      console.log('- Considerar re-importar os clientes n√£o encontrados');
    }
    
  } catch (error) {
    console.error('‚ùå Erro durante a compara√ß√£o:', error);
  } finally {
    // Fechar conex√£o
    await mongoose.connection.close();
    console.log('\nüîå Conex√£o com o banco fechada');
  }
}

// Executar compara√ß√£o
compararNomes();

